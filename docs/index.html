<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>AWSPrepAI - AWS Certification Study Tool</title>
  <meta name="description" content="Master AWS certifications with practice questions, flashcards, and mock exams. Cloud Practitioner & Solutions Architect.">
  <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>‚òÅÔ∏è</text></svg>">
  <style>
    :root{--bg:#0f172a;--card:#1e293b;--accent:#f59e0b;--accent-2:#fbbf24;--success:#10b981;--warning:#f59e0b;--danger:#ef4444;--text:#f1f5f9;--muted:#94a3b8;--border:#334155;--radius:12px;--aws-orange:#ff9900}
    *{box-sizing:border-box;margin:0;padding:0}
    body{font-family:'Inter',-apple-system,BlinkMacSystemFont,'Segoe UI',sans-serif;background:var(--bg);color:var(--text);line-height:1.6;min-height:100vh}
    .container{max-width:1200px;margin:0 auto;padding:1rem}
    header{background:linear-gradient(135deg,#232f3e 0%,#1a2332 100%);border-bottom:3px solid var(--aws-orange);padding:1rem 0}
    .header-content{display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap;gap:1rem}
    .logo{display:flex;align-items:center;gap:.75rem;font-size:1.5rem;font-weight:800;color:var(--aws-orange);text-decoration:none}
    .cert-selector{background:var(--bg);border:2px solid var(--aws-orange);color:var(--text);padding:.5rem 1rem;border-radius:8px;font-size:.9rem;font-weight:600;cursor:pointer}
    .cert-selector:focus{outline:none}
    .nav-tabs{display:flex;gap:.5rem;flex-wrap:wrap}
    .nav-tab{background:transparent;border:1px solid var(--border);color:var(--muted);padding:.5rem 1rem;border-radius:8px;cursor:pointer;font-weight:600;transition:all .2s;font-size:.875rem}
    .nav-tab:hover{border-color:var(--aws-orange);color:var(--aws-orange)}
    .nav-tab.active{background:var(--aws-orange);color:#000;border-color:var(--aws-orange)}
    main{padding:1.5rem 0}
    .app-section{display:none}
    .app-section.active{display:block}
    .card{background:var(--card);border:1px solid var(--border);border-radius:var(--radius);padding:1.5rem;margin-bottom:1.5rem}
    .card-title{font-size:1.25rem;font-weight:700;margin-bottom:1rem;display:flex;align-items:center;gap:.5rem}
    .card-orange{border-left:4px solid var(--aws-orange)}
    .form-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:1rem}
    .btn{padding:.75rem 1.5rem;border-radius:8px;font-weight:700;cursor:pointer;transition:all .2s;border:none;font-size:.9rem}
    .btn-primary{background:var(--aws-orange);color:#000}
    .btn-primary:hover{background:var(--accent-2)}
    .btn-success{background:var(--success);color:#fff}
    .btn-danger{background:var(--danger);color:#fff}
    .btn-secondary{background:var(--card);color:var(--text);border:1px solid var(--border)}
    .btn-group{display:flex;gap:.5rem;flex-wrap:wrap;margin-top:1rem}
    .stats-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(140px,1fr));gap:1rem;margin-bottom:1.5rem}
    .stat-card{background:var(--card);padding:1.25rem;border-radius:var(--radius);text-align:center;border:1px solid var(--border)}
    .stat-value{font-size:2rem;font-weight:800;color:var(--aws-orange)}
    .stat-label{font-size:.75rem;color:var(--muted);margin-top:.25rem}
    .progress-bar{background:var(--border);border-radius:999px;height:12px;margin:.5rem 0;overflow:hidden}
    .progress-fill{height:100%;border-radius:999px;transition:width .3s}
    .progress-fill.good{background:var(--success)}
    .progress-fill.medium{background:var(--warning)}
    .progress-fill.low{background:var(--danger)}
    .quiz-question{font-size:1.25rem;margin-bottom:1.5rem;line-height:1.5}
    .quiz-options{display:grid;gap:.75rem}
    .quiz-option{background:var(--bg);padding:1rem;border-radius:8px;cursor:pointer;border:2px solid var(--border);transition:all .2s}
    .quiz-option:hover{border-color:var(--aws-orange);background:#232f3e}
    .quiz-option.correct{border-color:var(--success);background:rgba(16,185,129,.15)}
    .quiz-option.incorrect{border-color:var(--danger);background:rgba(239,68,68,.15)}
    .data-list{max-height:400px;overflow-y:auto}
    .data-item{background:var(--bg);padding:1rem;border-radius:8px;margin-bottom:.5rem;display:flex;justify-content:space-between;align-items:center;cursor:pointer;transition:all .2s}
    .data-item:hover{border-left:3px solid var(--aws-orange)}
    .data-item-info{flex:1}
    .data-item-title{font-weight:600}
    .data-item-meta{font-size:.875rem;color:var(--muted)}
    .data-item-value{font-size:1.25rem;font-weight:700}
    .insight{background:var(--bg);padding:1rem;border-radius:8px;margin-bottom:.75rem;border-left:4px solid var(--aws-orange)}
    .insight.positive{border-left-color:var(--success)}
    .insight.warning{border-left-color:var(--warning)}
    .service-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(280px,1fr));gap:1rem}
    .service-card{background:var(--bg);padding:1rem;border-radius:8px;border-left:4px solid var(--aws-orange)}
    .service-name{font-weight:700;font-size:1.1rem;color:var(--aws-orange)}
    .service-desc{font-size:.9rem;color:var(--muted);margin-top:.5rem}
    .exam-timer{font-size:2rem;font-weight:800;color:var(--aws-orange);text-align:center;padding:1rem}
    .cert-badge{display:inline-block;padding:.25rem .75rem;border-radius:999px;font-size:.75rem;font-weight:700;margin-left:.5rem}
    .cert-badge.clf{background:#10b981;color:#fff}
    .cert-badge.saa{background:#3b82f6;color:#fff}
    @media(max-width:768px){.nav-tabs{justify-content:center}.header-content{justify-content:center;flex-direction:column}.stats-grid{grid-template-columns:repeat(2,1fr)}}
  </style>
</head>
<body>
  <header>
    <div class="container">
      <div class="header-content">
        <div style="display:flex;align-items:center;gap:1rem;flex-wrap:wrap">
          <a href="#" class="logo">‚òÅÔ∏è AWSPrepAI</a>
          <select class="cert-selector" id="certSelector" onchange="switchCert()">
            <option value="clf">‚òÅÔ∏è Cloud Practitioner (CLF-C02)</option>
            <option value="saa">üèóÔ∏è Solutions Architect (SAA-C03)</option>
          </select>
        </div>
        <nav class="nav-tabs">
          <button class="nav-tab active" data-tab="dashboard"><span class="icon">üìä</span><span>Dashboard</span></button>
          <button class="nav-tab" data-tab="quiz"><span class="icon">‚ùì</span><span>Practice</span></button>
          <button class="nav-tab" data-tab="exam"><span class="icon">üìù</span><span>Mock Exam</span></button>
          <button class="nav-tab" data-tab="services"><span class="icon">üìö</span><span>Services</span></button>
        </nav>
      </div>
    </div>
  </header>

  <main class="container">
    <!-- Dashboard -->
    <section id="dashboard" class="app-section active">
      <div class="card card-orange">
        <div class="card-title">üéØ Current Certification: <span id="currentCertName">Cloud Practitioner</span><span class="cert-badge clf" id="certBadge">CLF-C02</span></div>
        <p style="color:var(--muted)">Pass score: <span id="passScore">70%</span> | Questions: <span id="examQuestions">65</span> | Time: <span id="examTime">90 min</span></p>
      </div>

      <div class="stats-grid">
        <div class="stat-card"><div class="stat-value" id="totalAnswered">0</div><div class="stat-label">Questions Answered</div></div>
        <div class="stat-card"><div class="stat-value" id="totalAccuracy">--%</div><div class="stat-label">Overall Accuracy</div></div>
        <div class="stat-card"><div class="stat-value" id="bestStreak">0</div><div class="stat-label">Best Streak</div></div>
        <div class="stat-card"><div class="stat-value" id="examReady">No</div><div class="stat-label">Exam Ready?</div></div>
      </div>

      <div class="card">
        <div class="card-title">üìà Progress by Domain</div>
        <div class="form-grid" id="domainProgress"></div>
      </div>

      <div class="card">
        <div class="card-title">‚ö†Ô∏è Weak Areas</div>
        <div id="weakAreas" class="data-list">
          <div class="insight">Complete some questions to identify weak areas!</div>
        </div>
      </div>
    </section>

    <!-- Practice Quiz -->
    <section id="quiz" class="app-section">
      <div class="card">
        <div class="card-title">üéØ Select Domain</div>
        <div class="btn-group" id="categoryBtns"></div>
      </div>

      <div class="card card-orange">
        <div class="card-title">‚òÅÔ∏è <span id="quizCertTitle">AWS Cloud Practitioner</span> <span id="questionCounter" style="font-weight:400;color:var(--muted);font-size:.9rem"></span></div>
        <div id="quizCategory" style="color:var(--aws-orange);font-size:.875rem;margin-bottom:.5rem"></div>
        <div class="quiz-question" id="quizQuestion">Loading question...</div>
        <div class="quiz-options" id="quizOptions"></div>
        <div id="quizExplanation" style="display:none;margin-top:1rem;padding:1rem;background:var(--bg);border-radius:8px;border-left:4px solid var(--aws-orange)"></div>
        <div class="btn-group" style="margin-top:1.5rem">
          <button class="btn btn-primary" id="nextQuizBtn" onclick="nextQuestion()" style="display:none">Next Question ‚Üí</button>
          <button class="btn btn-secondary" onclick="resetQuiz()">üîÑ Reset Progress</button>
        </div>
      </div>
    </section>

    <!-- Mock Exam -->
    <section id="exam" class="app-section">
      <div class="card card-orange">
        <div class="card-title">üìù Mock Certification Exam</div>
        <div id="examStart">
          <div class="stats-grid">
            <div class="stat-card"><div class="stat-value" id="examQCount">65</div><div class="stat-label">Questions</div></div>
            <div class="stat-card"><div class="stat-value" id="examTCount">90</div><div class="stat-label">Minutes</div></div>
            <div class="stat-card"><div class="stat-value" id="examPScore">70%</div><div class="stat-label">Pass Score</div></div>
          </div>
          <button class="btn btn-primary" onclick="startExam()" style="width:100%;padding:1rem;font-size:1.1rem">üöÄ Start Mock Exam</button>
        </div>
        <div id="examInProgress" style="display:none">
          <div class="exam-timer" id="examTimer">90:00</div>
          <div style="text-align:center;color:var(--muted);margin-bottom:1rem" id="examProgress">Question 1 of 65</div>
          <div class="quiz-question" id="examQuestion"></div>
          <div class="quiz-options" id="examOptions"></div>
          <div class="btn-group" style="margin-top:1.5rem">
            <button class="btn btn-primary" onclick="examNext()">Next ‚Üí</button>
            <button class="btn btn-danger" onclick="endExam()">End Exam</button>
          </div>
        </div>
        <div id="examResults" style="display:none">
          <div class="stats-grid">
            <div class="stat-card"><div class="stat-value" id="examScore">0%</div><div class="stat-label">Your Score</div></div>
            <div class="stat-card"><div class="stat-value" id="examCorrect">0</div><div class="stat-label">Correct</div></div>
            <div class="stat-card"><div class="stat-value" id="examResult">--</div><div class="stat-label">Result</div></div>
          </div>
          <button class="btn btn-primary" onclick="restartExam()" style="width:100%">Try Again</button>
        </div>
      </div>
    </section>

    <!-- Services Reference -->
    <section id="services" class="app-section">
      <div class="card">
        <div class="card-title">üîç Search AWS Services</div>
        <input type="text" id="serviceSearch" placeholder="Search services..." style="width:100%;padding:.75rem;border:1px solid var(--border);border-radius:8px;background:var(--bg);color:var(--text);font-size:1rem" oninput="filterServices()">
      </div>
      <div class="service-grid" id="serviceGrid"></div>
    </section>
  </main>

  <script>
    const DB = {
      get: (key) => JSON.parse(localStorage.getItem('awsprep_' + key) || '[]'),
      set: (key, data) => localStorage.setItem('awsprep_' + key, JSON.stringify(data)),
      getOne: (key) => JSON.parse(localStorage.getItem('awsprep_' + key) || 'null'),
      setOne: (key, data) => localStorage.setItem('awsprep_' + key, JSON.stringify(data))
    };

    // Tab Navigation
    document.querySelectorAll('.nav-tab').forEach(tab => {
      tab.addEventListener('click', () => {
        document.querySelectorAll('.nav-tab').forEach(t => t.classList.remove('active'));
        document.querySelectorAll('.app-section').forEach(s => s.classList.remove('active'));
        tab.classList.add('active');
        document.getElementById(tab.dataset.tab).classList.add('active');
      });
    });

    // Certification Data
    const certifications = {
      clf: {
        name: "Cloud Practitioner",
        code: "CLF-C02",
        passScore: 70,
        questions: 65,
        time: 90,
        domains: ["cloud-concepts", "security", "technology", "billing"],
        domainLabels: { "cloud-concepts": "‚òÅÔ∏è Cloud Concepts", "security": "üîê Security", "technology": "üñ•Ô∏è Technology", "billing": "üí∞ Billing & Pricing" }
      },
      saa: {
        name: "Solutions Architect Associate",
        code: "SAA-C03",
        passScore: 72,
        questions: 65,
        time: 130,
        domains: ["design-secure", "design-resilient", "design-performant", "design-cost"],
        domainLabels: { "design-secure": "üîê Secure Architectures", "design-resilient": "üõ°Ô∏è Resilient Architectures", "design-performant": "‚ö° High-Performing", "design-cost": "üí∞ Cost-Optimized" }
      }
    };

    // CLF-C02 Questions
    const clfQuestions = [
      { cat: "cloud-concepts", q: "What does EC2 stand for?", options: ["Elastic Compute Cloud", "Electronic Computing Center", "Enterprise Cloud Computing", "Elastic Container Cluster"], answer: 0, explain: "EC2 = Elastic Compute Cloud. Virtual servers in the cloud." },
      { cat: "cloud-concepts", q: "What is AWS Lambda?", options: ["Database service", "Serverless compute", "Storage service", "Networking tool"], answer: 1, explain: "Lambda runs code without provisioning servers." },
      { cat: "cloud-concepts", q: "Which service provides object storage?", options: ["EBS", "S3", "RDS", "EC2"], answer: 1, explain: "S3 (Simple Storage Service) stores objects with unlimited scalability." },
      { cat: "cloud-concepts", q: "What is the benefit of cloud computing elasticity?", options: ["Lower security", "Fixed capacity", "Scale up/down based on demand", "Higher latency"], answer: 2, explain: "Elasticity means automatically adjusting resources to match demand." },
      { cat: "cloud-concepts", q: "What is a Region in AWS?", options: ["A single data center", "A geographical area with multiple AZs", "A virtual network", "A security group"], answer: 1, explain: "A Region is a geographical area containing multiple Availability Zones." },
      { cat: "cloud-concepts", q: "What is an Availability Zone?", options: ["Multiple regions combined", "One or more data centers", "A virtual machine", "A storage bucket"], answer: 1, explain: "An AZ is one or more discrete data centers with redundant power and networking." },
      { cat: "cloud-concepts", q: "What EC2 pricing offers biggest discount for long-term?", options: ["On-Demand", "Spot", "Reserved Instances", "Dedicated"], answer: 2, explain: "Reserved Instances offer up to 72% discount for 1-3 year commitments." },
      { cat: "cloud-concepts", q: "What are Spot Instances?", options: ["Free instances", "Unused capacity at discount", "Premium instances", "Dedicated hardware"], answer: 1, explain: "Spot uses spare EC2 capacity at up to 90% discount but can be interrupted." },
      { cat: "cloud-concepts", q: "What is AWS Elastic Beanstalk?", options: ["Container service", "PaaS for apps", "Database", "CDN"], answer: 1, explain: "Elastic Beanstalk is PaaS that handles deployment automatically." },
      { cat: "cloud-concepts", q: "What does an AMI contain?", options: ["Just OS", "Template for EC2", "Container images", "Database"], answer: 1, explain: "AMI is a template with OS, applications, and configurations." },

      { cat: "security", q: "What does IAM stand for?", options: ["Internet Access Management", "Identity and Access Management", "Integrated Application Module", "Instance Availability Manager"], answer: 1, explain: "IAM manages users, groups, roles, and permissions." },
      { cat: "security", q: "What is the shared responsibility model?", options: ["AWS manages all", "Customer manages all", "AWS: infrastructure, Customer: data", "Only enterprise"], answer: 2, explain: "AWS secures the cloud; customers secure what's IN the cloud." },
      { cat: "security", q: "What is an IAM role?", options: ["User account", "Temporary credentials", "Group of users", "Password policy"], answer: 1, explain: "Roles provide temporary credentials for services or cross-account access." },
      { cat: "security", q: "Which service provides DDoS protection?", options: ["WAF", "Shield", "GuardDuty", "Inspector"], answer: 1, explain: "AWS Shield provides DDoS protection." },
      { cat: "security", q: "What is AWS KMS?", options: ["Container management", "Key management", "Kubernetes", "Monitoring"], answer: 1, explain: "KMS creates and manages encryption keys." },
      { cat: "security", q: "What is MFA?", options: ["Multiple Firewall Access", "Multi-Factor Authentication", "Managed File Access", "Main Function Admin"], answer: 1, explain: "MFA adds an extra authentication factor beyond password." },
      { cat: "security", q: "What is principle of least privilege?", options: ["Max permissions", "Only needed permissions", "No permissions", "Admin for all"], answer: 1, explain: "Grant only minimum permissions required for a task." },
      { cat: "security", q: "What does AWS WAF protect against?", options: ["DDoS only", "SQL injection & XSS", "Physical theft", "Power outage"], answer: 1, explain: "WAF protects web apps from common exploits." },

      { cat: "technology", q: "What is VPC?", options: ["Virtual Private Cloud", "Virtual Processing Center", "Verified Public Connection", "Variable Pricing"], answer: 0, explain: "VPC is your isolated network in AWS." },
      { cat: "technology", q: "What is CloudFront?", options: ["DNS service", "CDN", "Database", "Compute"], answer: 1, explain: "CloudFront is a CDN for fast global content delivery." },
      { cat: "technology", q: "What is Route 53?", options: ["CDN", "DNS service", "VPN", "Storage"], answer: 1, explain: "Route 53 is DNS and domain registration service." },
      { cat: "technology", q: "What database is DynamoDB?", options: ["Relational", "Graph", "NoSQL key-value", "Time-series"], answer: 2, explain: "DynamoDB is NoSQL with single-digit ms latency." },
      { cat: "technology", q: "What is RDS?", options: ["NoSQL database", "Managed relational DB", "Cache", "Storage"], answer: 1, explain: "RDS manages MySQL, PostgreSQL, SQL Server, etc." },
      { cat: "technology", q: "What is ElastiCache for?", options: ["Storage", "In-memory caching", "Compute", "Networking"], answer: 1, explain: "ElastiCache provides Redis or Memcached caching." },
      { cat: "technology", q: "What is EBS?", options: ["Object storage", "Block storage for EC2", "File storage", "Archive"], answer: 1, explain: "EBS provides persistent block storage for EC2." },
      { cat: "technology", q: "What is EFS?", options: ["Block storage", "Shared file system", "Object storage", "Archive"], answer: 1, explain: "EFS is shared NFS file storage for multiple EC2." },

      { cat: "billing", q: "What is AWS Free Tier?", options: ["Always free only", "12 months free for new accounts", "Students only", "None"], answer: 1, explain: "Free Tier includes 12 months limited free usage plus always-free services." },
      { cat: "billing", q: "What is Cost Explorer?", options: ["Service catalog", "Visualize costs", "Calculator", "Alarm"], answer: 1, explain: "Cost Explorer visualizes spending patterns." },
      { cat: "billing", q: "What estimates costs before deployment?", options: ["Cost Explorer", "Pricing Calculator", "Budgets", "Trusted Advisor"], answer: 1, explain: "Pricing Calculator estimates costs before use." },
      { cat: "billing", q: "What is AWS Budgets?", options: ["Calculate prices", "Set cost alerts", "Pay bills", "Get refunds"], answer: 1, explain: "Budgets sets alerts when costs exceed thresholds." },
      { cat: "billing", q: "Which support has TAM?", options: ["Basic", "Developer", "Business", "Enterprise"], answer: 3, explain: "Enterprise Support includes Technical Account Manager." },
      { cat: "billing", q: "What is always free?", options: ["EC2 t2.micro", "S3 5GB", "IAM", "RDS"], answer: 2, explain: "IAM is always free - no charge for users, roles, policies." },
      { cat: "billing", q: "What is Consolidated Billing?", options: ["Single bill for multiple accounts", "Installments", "Auto discounts", "Free tier extension"], answer: 0, explain: "Combines usage across accounts for volume discounts." },
      { cat: "billing", q: "On-Demand pricing means?", options: ["Long commitment", "No upfront, pay as you go", "Reserved", "Free"], answer: 1, explain: "On-Demand: pay by hour/second with no commitment." }
    ];

    // SAA-C03 Questions (Solutions Architect) - Full 65-Question Mock Exam
    const saaQuestions = [
      // Design Secure Architectures (16 questions)
      { cat: "design-secure", q: "A Lambda function in Account A needs to access an S3 bucket in Account B. What is required?", options: ["Only IAM role in Account A", "Only bucket policy in Account B", "IAM execution role + resource-based bucket policy", "VPC peering between accounts"], answer: 2, explain: "Cross-account access requires both identity-based policy (IAM role) AND resource-based policy (bucket policy) working together." },
      { cat: "design-secure", q: "How to enable EC2 instances to access S3 without storing credentials?", options: ["Store access keys in environment variables", "Attach IAM role to EC2 instance", "Use S3 pre-signed URLs only", "Enable public access on bucket"], answer: 1, explain: "IAM roles attached to EC2 provide temporary credentials automatically rotated by AWS STS." },
      { cat: "design-secure", q: "What enables private connectivity from VPC to S3 without internet?", options: ["Internet Gateway", "NAT Gateway", "VPC Gateway Endpoint", "AWS PrivateLink"], answer: 2, explain: "VPC Gateway Endpoints for S3 and DynamoDB allow private access without traversing the internet." },
      { cat: "design-secure", q: "Which KMS key type does AWS fully manage including rotation?", options: ["Customer managed CMK", "AWS managed key", "Imported key material", "CloudHSM key"], answer: 1, explain: "AWS managed keys are created, managed, and rotated automatically by AWS for integrated services." },
      { cat: "design-secure", q: "How to restrict S3 bucket access to only requests from a specific VPC?", options: ["Security group rules", "Bucket policy with aws:sourceVpc condition", "S3 Access Points only", "IAM user policies"], answer: 1, explain: "Bucket policies with aws:sourceVpc or aws:sourceVpce conditions restrict access to specific VPCs/endpoints." },
      { cat: "design-secure", q: "What automatically encrypts all new EBS volumes?", options: ["Lambda function on creation", "Account-level default EBS encryption", "CloudWatch Events trigger", "EC2 user data script"], answer: 1, explain: "Enable default EBS encryption at the account/region level to auto-encrypt all new volumes." },
      { cat: "design-secure", q: "Which service uses ML to continuously monitor for malicious activity?", options: ["AWS Inspector", "Amazon GuardDuty", "AWS Config", "AWS Shield"], answer: 1, explain: "GuardDuty uses machine learning and threat intelligence to detect threats across AWS accounts." },
      { cat: "design-secure", q: "How should secrets be stored for an application running on EC2?", options: ["Hardcoded in application code", "Environment variables in user data", "AWS Secrets Manager with IAM role", "S3 bucket with encryption"], answer: 2, explain: "Secrets Manager securely stores and automatically rotates secrets, accessed via IAM roles." },
      { cat: "design-secure", q: "What provides web application protection against SQL injection and XSS?", options: ["Security Groups", "NACLs", "AWS WAF", "AWS Shield Standard"], answer: 2, explain: "AWS WAF (Web Application Firewall) protects against common web exploits like SQLi and XSS." },
      { cat: "design-secure", q: "How to enforce MFA for all IAM users accessing the AWS Console?", options: ["Enable MFA on root only", "IAM policy with aws:MultiFactorAuthPresent condition", "Security Hub requirement", "CloudTrail logging"], answer: 1, explain: "IAM policies with MFA conditions can deny access unless MFA is authenticated." },
      { cat: "design-secure", q: "Which service discovers and protects sensitive data in S3?", options: ["AWS Inspector", "Amazon Macie", "AWS Config", "S3 Object Lock"], answer: 1, explain: "Amazon Macie uses ML to discover, classify, and protect sensitive data like PII in S3." },
      { cat: "design-secure", q: "How to securely connect on-premises network to AWS VPC?", options: ["Internet Gateway", "AWS Site-to-Site VPN", "NAT Gateway", "VPC Peering"], answer: 1, explain: "Site-to-Site VPN creates encrypted IPsec tunnel between on-premises and AWS VPC." },
      { cat: "design-secure", q: "What validates that AWS resources comply with security policies?", options: ["AWS Config Rules", "CloudWatch Alarms", "CloudTrail Logs", "IAM Access Analyzer"], answer: 0, explain: "AWS Config Rules evaluate resource configurations against desired security settings." },
      { cat: "design-secure", q: "How to grant temporary cross-account access without sharing credentials?", options: ["Share IAM user credentials", "IAM role with trust policy for external account", "Create IAM user in both accounts", "Use same root account"], answer: 1, explain: "IAM roles with cross-account trust policies allow secure temporary access via AssumeRole." },
      { cat: "design-secure", q: "What encrypts data in transit to RDS?", options: ["KMS encryption", "SSL/TLS certificates", "S3 SSE", "EBS encryption"], answer: 1, explain: "SSL/TLS encrypts data in transit; KMS/EBS encrypts at rest." },
      { cat: "design-secure", q: "Which service provides centralized security findings across AWS accounts?", options: ["AWS Organizations", "AWS Security Hub", "Amazon Detective", "AWS Artifact"], answer: 1, explain: "Security Hub aggregates security findings from GuardDuty, Inspector, Macie, and third-party tools." },

      // Design Resilient Architectures (17 questions)
      { cat: "design-resilient", q: "What automatically replaces unhealthy EC2 instances?", options: ["Elastic Load Balancer", "Auto Scaling Group", "Route 53 health checks", "CloudWatch Alarms"], answer: 1, explain: "Auto Scaling Groups detect unhealthy instances and automatically launch replacements." },
      { cat: "design-resilient", q: "Minimum number of Availability Zones for high availability?", options: ["1", "2", "3", "4"], answer: 1, explain: "At least 2 AZs are required for high availability to survive a single AZ failure." },
      { cat: "design-resilient", q: "What replicates S3 objects to another AWS Region automatically?", options: ["S3 Transfer Acceleration", "S3 Cross-Region Replication", "S3 Lifecycle Rules", "AWS DataSync"], answer: 1, explain: "S3 CRR automatically replicates objects to a bucket in another region for DR." },
      { cat: "design-resilient", q: "What does RDS Multi-AZ deployment provide?", options: ["Read scaling", "Automatic failover to standby", "Cost reduction", "Cross-region replication"], answer: 1, explain: "Multi-AZ maintains a synchronous standby replica with automatic failover." },
      { cat: "design-resilient", q: "How does Route 53 improve availability?", options: ["Caches DNS responses", "Health checks with failover routing", "Reduces latency only", "Provides DDoS protection"], answer: 1, explain: "Route 53 health checks detect failures and route traffic to healthy endpoints." },
      { cat: "design-resilient", q: "What is the durability of S3 Standard?", options: ["99.9%", "99.99%", "99.999999999% (11 9s)", "99.95%"], answer: 2, explain: "S3 Standard provides 99.999999999% durability by storing across multiple AZs." },
      { cat: "design-resilient", q: "What decouples application components for better fault tolerance?", options: ["Direct synchronous API calls", "Amazon SQS queues", "Shared database", "Hard-coded endpoints"], answer: 1, explain: "SQS queues decouple producers and consumers, allowing independent scaling and failure handling." },
      { cat: "design-resilient", q: "Aurora provides automatic failover to which resource?", options: ["Read Replica in same region", "Standby in another AZ", "S3 backup", "Manual snapshot"], answer: 0, explain: "Aurora automatically promotes a read replica to primary during failure." },
      { cat: "design-resilient", q: "How to protect against Regional AWS outages?", options: ["Multiple AZs only", "Multi-Region architecture", "Larger instance types", "More security groups"], answer: 1, explain: "Multi-Region deployments with Route 53 failover protect against regional failures." },
      { cat: "design-resilient", q: "What enables stateless application design for better scaling?", options: ["Store sessions in EC2 memory", "Store sessions in ElastiCache/DynamoDB", "Use sticky sessions only", "Single large instance"], answer: 1, explain: "External session storage (ElastiCache/DynamoDB) enables stateless instances that scale horizontally." },
      { cat: "design-resilient", q: "Lambda function timeout and how to handle long processes?", options: ["Increase to 24 hours", "Use Step Functions for orchestration", "Run synchronously only", "Disable timeout"], answer: 1, explain: "Lambda has 15-minute max timeout; Step Functions orchestrate long-running workflows." },
      { cat: "design-resilient", q: "What AWS service provides managed message queuing with exactly-once processing?", options: ["Amazon SNS", "Amazon SQS FIFO", "Amazon Kinesis", "AWS EventBridge"], answer: 1, explain: "SQS FIFO queues provide exactly-once processing and message ordering." },
      { cat: "design-resilient", q: "How to ensure DynamoDB data survives regional disaster?", options: ["Point-in-time recovery only", "DynamoDB Global Tables", "Export to S3 daily", "Provisioned capacity"], answer: 1, explain: "Global Tables provide multi-region, multi-active replication with automatic failover." },
      { cat: "design-resilient", q: "What enables EBS volume recovery from point-in-time snapshots?", options: ["EBS Lifecycle Manager", "AWS Backup", "Both A and B", "Manual snapshots only"], answer: 2, explain: "Both EBS Lifecycle Manager and AWS Backup automate EBS snapshot scheduling." },
      { cat: "design-resilient", q: "How does Application Load Balancer improve resilience?", options: ["Terminates SSL only", "Distributes traffic across healthy targets in multiple AZs", "Provides static IPs", "Blocks DDoS attacks"], answer: 1, explain: "ALB health checks route traffic only to healthy targets across multiple AZs." },
      { cat: "design-resilient", q: "What is the RTO difference between Multi-AZ and Read Replicas?", options: ["Same RTO", "Multi-AZ: minutes, Read Replica: manual promotion", "Read Replica faster", "Neither provides DR"], answer: 1, explain: "Multi-AZ provides automatic failover (1-2 min); Read Replica requires manual promotion." },
      { cat: "design-resilient", q: "How to implement circuit breaker pattern in AWS?", options: ["Security Groups", "Step Functions with error handling", "CloudWatch Alarms", "VPC Flow Logs"], answer: 1, explain: "Step Functions can implement circuit breakers with retry logic and error states." },

      // Design High-Performing Architectures (16 questions)
      { cat: "design-performant", q: "What caches frequently accessed database queries?", options: ["RDS Proxy", "Amazon ElastiCache", "DynamoDB DAX", "Both B and C"], answer: 3, explain: "ElastiCache (Redis/Memcached) caches RDS queries; DAX caches DynamoDB queries." },
      { cat: "design-performant", q: "Which EBS volume type provides highest IOPS?", options: ["gp3", "io2 Block Express", "st1", "sc1"], answer: 1, explain: "io2 Block Express provides up to 256,000 IOPS for demanding workloads." },
      { cat: "design-performant", q: "What accelerates global uploads to S3?", options: ["CloudFront", "S3 Transfer Acceleration", "Direct Connect", "S3 Intelligent-Tiering"], answer: 1, explain: "Transfer Acceleration uses CloudFront edge locations for faster long-distance uploads." },
      { cat: "design-performant", q: "How does CloudFront improve application performance?", options: ["Larger EC2 instances", "Edge location caching near users", "Database optimization", "Load balancing"], answer: 1, explain: "CloudFront caches content at 400+ edge locations, reducing latency globally." },
      { cat: "design-performant", q: "What provides microsecond latency for DynamoDB reads?", options: ["Provisioned capacity", "DynamoDB Accelerator (DAX)", "Global Tables", "On-demand capacity"], answer: 1, explain: "DAX is an in-memory cache providing microsecond read latency for DynamoDB." },
      { cat: "design-performant", q: "How to scale Lambda function performance?", options: ["Increase instance type", "Allocate more memory (also increases CPU)", "Add more ENIs", "Use larger VPC"], answer: 1, explain: "Lambda CPU scales proportionally with memory allocation (128MB to 10GB)." },
      { cat: "design-performant", q: "What offloads read traffic from primary RDS database?", options: ["Multi-AZ standby", "Read Replicas", "RDS Proxy", "Parameter groups"], answer: 1, explain: "Read Replicas handle read queries, scaling read capacity up to 5x (15 for Aurora)." },
      { cat: "design-performant", q: "How does Global Accelerator improve performance?", options: ["Database caching", "Routes traffic over AWS global network", "Increases instance size", "Compresses data"], answer: 1, explain: "Global Accelerator uses anycast IPs and AWS backbone for consistent low latency." },
      { cat: "design-performant", q: "What is the best storage for high-performance computing (HPC)?", options: ["EBS gp2", "Amazon FSx for Lustre", "S3 Standard", "EFS General Purpose"], answer: 1, explain: "FSx for Lustre provides sub-millisecond latencies for HPC and ML workloads." },
      { cat: "design-performant", q: "How to reduce Lambda cold starts?", options: ["Smaller package size", "Provisioned Concurrency", "Longer timeout", "Both A and B"], answer: 3, explain: "Smaller packages and Provisioned Concurrency both reduce cold start times." },
      { cat: "design-performant", q: "What enables parallel processing of Kinesis data streams?", options: ["Single shard", "Multiple shards", "Batch processing only", "S3 export"], answer: 1, explain: "Each Kinesis shard provides 1MB/s input, 2MB/s output; add shards for parallelism." },
      { cat: "design-performant", q: "How to optimize SQL database queries on RDS?", options: ["Increase storage", "Enable Performance Insights and optimize slow queries", "Use Multi-AZ", "Disable encryption"], answer: 1, explain: "Performance Insights identifies bottlenecks; optimize indexes and queries accordingly." },
      { cat: "design-performant", q: "What provides persistent, shared file storage for EC2 with high throughput?", options: ["EBS", "Instance Store", "Amazon EFS", "S3"], answer: 2, explain: "EFS provides shared NFS storage that scales automatically with high throughput modes." },
      { cat: "design-performant", q: "How to handle traffic spikes for a web application?", options: ["Manual scaling", "Auto Scaling with target tracking", "Single large instance", "Scheduled scaling only"], answer: 1, explain: "Target tracking Auto Scaling automatically adjusts capacity based on metrics like CPU." },
      { cat: "design-performant", q: "What is the fastest way to query large datasets in S3?", options: ["Download and process locally", "S3 Select / Athena", "Transfer to EC2 first", "Use CloudFront"], answer: 1, explain: "S3 Select and Athena query data in-place without full download, improving speed." },
      { cat: "design-performant", q: "How does RDS Proxy improve database performance?", options: ["Query caching", "Connection pooling and multiplexing", "Read replication", "Storage optimization"], answer: 1, explain: "RDS Proxy pools connections, reducing database overhead from many Lambda functions." },

      // Design Cost-Optimized Architectures (16 questions)
      { cat: "design-cost", q: "Most cost-effective option for steady-state, predictable workloads?", options: ["On-Demand Instances", "Spot Instances", "Reserved Instances or Savings Plans", "Dedicated Hosts"], answer: 2, explain: "Reserved Instances and Savings Plans offer up to 72% discount for committed usage." },
      { cat: "design-cost", q: "Cheapest S3 storage class for rarely accessed archive data?", options: ["S3 Standard", "S3 Standard-IA", "S3 Glacier Deep Archive", "S3 One Zone-IA"], answer: 2, explain: "Glacier Deep Archive is cheapest at ~$1/TB/month for long-term archives." },
      { cat: "design-cost", q: "What automatically moves S3 objects to cheaper storage classes?", options: ["S3 Versioning", "S3 Lifecycle Policies", "S3 Replication", "S3 Object Lock"], answer: 1, explain: "Lifecycle policies transition objects based on age (e.g., to IA after 30 days)." },
      { cat: "design-cost", q: "Best use case for Spot Instances?", options: ["Production databases", "Fault-tolerant batch processing", "Mission-critical web servers", "Stateful applications"], answer: 1, explain: "Spot Instances are ideal for interruptible workloads like batch jobs, CI/CD, big data." },
      { cat: "design-cost", q: "What does right-sizing EC2 instances achieve?", options: ["Maximum performance", "Matching resources to actual usage needs", "More availability zones", "Automatic scaling"], answer: 1, explain: "Right-sizing eliminates waste by using appropriately sized instances for workloads." },
      { cat: "design-cost", q: "Which service identifies cost optimization opportunities?", options: ["CloudWatch", "AWS Trusted Advisor", "AWS Config", "Systems Manager"], answer: 1, explain: "Trusted Advisor Cost Optimization checks for idle resources, underutilized instances." },
      { cat: "design-cost", q: "Why is serverless cost-effective for variable workloads?", options: ["Fixed monthly pricing", "Pay only for actual execution time/requests", "Free tier always applies", "Reserved capacity discounts"], answer: 1, explain: "Lambda charges per 1ms of execution; no cost when not running." },
      { cat: "design-cost", q: "Is data transfer between AZs in the same region free?", options: ["Yes, always free", "No, it costs ~$0.01/GB", "Free for EC2 only", "Free with VPC"], answer: 1, explain: "Cross-AZ data transfer is charged; design to minimize unnecessary cross-AZ traffic." },
      { cat: "design-cost", q: "How to reduce NAT Gateway costs for S3/DynamoDB access?", options: ["Larger NAT Gateway", "VPC Gateway Endpoints (free)", "Direct Connect", "Internet Gateway"], answer: 1, explain: "Gateway Endpoints for S3/DynamoDB are free and avoid NAT Gateway charges." },
      { cat: "design-cost", q: "What provides visibility into AWS spending patterns?", options: ["CloudTrail", "AWS Cost Explorer", "CloudWatch", "AWS Config"], answer: 1, explain: "Cost Explorer visualizes spending, forecasts costs, and identifies trends." },
      { cat: "design-cost", q: "How to optimize costs for infrequently accessed EFS data?", options: ["Delete old files", "EFS Infrequent Access storage class", "Move to S3 manually", "Use smaller instances"], answer: 1, explain: "EFS IA reduces storage costs by 92% for files not accessed frequently." },
      { cat: "design-cost", q: "What is the most cost-effective compute for containers?", options: ["EC2 On-Demand", "Fargate Spot", "Dedicated Hosts", "Outposts"], answer: 1, explain: "Fargate Spot provides up to 70% discount for fault-tolerant container workloads." },
      { cat: "design-cost", q: "How to prevent unexpected AWS bills?", options: ["Hope for the best", "AWS Budgets with alerts", "Check console daily", "Disable all services"], answer: 1, explain: "AWS Budgets alerts when spending approaches or exceeds defined thresholds." },
      { cat: "design-cost", q: "What is the benefit of Consolidated Billing?", options: ["Free services", "Volume discounts across accounts", "Automatic refunds", "Unlimited usage"], answer: 1, explain: "Consolidated Billing aggregates usage across accounts for volume pricing tiers." },
      { cat: "design-cost", q: "How to reduce costs for development/test environments?", options: ["Same as production", "Smaller instances, stop when not in use", "No backups needed", "Skip all testing"], answer: 1, explain: "Use smaller instances, stop outside business hours, use Spot for dev/test." },
      { cat: "design-cost", q: "What is S3 Intelligent-Tiering best for?", options: ["Archive data", "Unknown or changing access patterns", "Frequently accessed only", "One-time access"], answer: 1, explain: "Intelligent-Tiering automatically moves objects between tiers based on access patterns." },

      // Udemy Practice Exam - Additional 65 Questions
      // Design Resilient Architectures
      { cat: "design-resilient", q: "A company needs visual, code-free data transformation with profiling and lineage. Which service?", options: ["Amazon Athena", "AWS Glue DataBrew", "AWS Glue Studio", "Amazon AppFlow"], answer: 1, explain: "AWS Glue DataBrew provides visual data preparation with recipes, profiling, and lineage tracking - no code required." },
      { cat: "design-resilient", q: "SNS to Lambda notifications failing during peak 5000 req/sec. What's the issue?", options: ["SNS scalability limit", "Lambda concurrency quota exceeded", "Need more SNS servers", "Need more Lambda servers"], answer: 1, explain: "Lambda has account concurrency limits. Contact AWS support to raise the limit when SNS deliveries are throttled." },
      { cat: "design-resilient", q: "RDS Multi-AZ uses which replication type?", options: ["Asynchronous", "Synchronous", "Semi-synchronous", "Logical"], answer: 1, explain: "Multi-AZ uses synchronous replication for zero data loss. Read Replicas use asynchronous replication." },
      { cat: "design-resilient", q: "ALB routing based on URL path like /orders and /products?", options: ["Host-based routing", "Path-based routing", "Query string routing", "Header-based routing"], answer: 1, explain: "Path-based routing routes requests based on URL path patterns to different target groups." },
      { cat: "design-resilient", q: "SQS FIFO queue processing 1000 msg/sec. What batch size needed?", options: ["2 messages", "4 messages", "10 messages", "No batching needed"], answer: 1, explain: "FIFO supports 300 msg/sec default. With batching of 4, you get 1200 msg/sec (300 x 4)." },
      { cat: "design-resilient", q: "Protect S3 objects from accidental deletion?", options: ["S3 encryption", "Versioning + MFA Delete", "S3 lifecycle", "S3 replication"], answer: 1, explain: "Enable versioning to keep object versions, and MFA Delete to require MFA for permanent deletions." },
      { cat: "design-resilient", q: "Serverless solution to process game score updates in order?", options: ["SQS + EC2", "Kinesis + Lambda + DynamoDB", "SNS + EC2", "SQS + RDS"], answer: 1, explain: "Kinesis Data Streams with Lambda provides serverless, ordered message processing to DynamoDB." },
      { cat: "design-resilient", q: "Auto Scaling group with unbalanced AZs. How does rebalancing work?", options: ["Terminates first, then launches", "Launches first, then terminates", "Simultaneous", "Manual intervention"], answer: 1, explain: "ASG launches new instances before terminating old ones during rebalancing to maintain availability." },
      { cat: "design-resilient", q: "CloudWatch metric filter for CloudTrail to detect illegal API calls?", options: ["Use CloudTrail Insights only", "Create metric filter + alarm + SNS", "Use Athena queries", "Use Trusted Advisor"], answer: 1, explain: "Create CloudWatch metric filter on CloudTrail logs, set alarm on the metric, notify via SNS." },
      { cat: "design-resilient", q: "Government app needs exactly-once message processing. Which service?", options: ["SQS Standard", "SQS FIFO", "SNS", "EventBridge"], answer: 1, explain: "SQS FIFO queues guarantee exactly-once processing and message ordering." },
      { cat: "design-resilient", q: "EC2 maintenance in ASG without replacement. Best approach?", options: ["Delete ASG", "Put instance in Standby state", "Terminate instance", "Disable health checks globally"], answer: 1, explain: "Standby state keeps instance in ASG but excludes from load balancing during maintenance." },
      { cat: "design-resilient", q: "Scheduled Auto Scaling for month-end peak. Set desired capacity to?", options: ["Min count", "Max count", "Desired capacity to 10", "Both min and max to 10"], answer: 2, explain: "Use scheduled action with desired capacity for exact instance count at specific times." },

      // Design Secure Architectures
      { cat: "design-secure", q: "Root user security best practices?", options: ["Share credentials with owner", "Strong password + MFA", "Create access keys always", "Email password to backup"], answer: 1, explain: "Use strong password, enable MFA, never share credentials, avoid creating root access keys." },
      { cat: "design-secure", q: "Restrict live streaming to USA only. Which services?", options: ["Route 53 weighted + failover", "CloudFront geo-restriction + Route 53 geolocation", "VPC security groups", "Route 53 latency routing"], answer: 1, explain: "CloudFront geo-restriction and Route 53 geolocation routing restrict content by country." },
      { cat: "design-secure", q: "Encrypt S3 data with audit trail of key usage?", options: ["SSE-S3", "SSE-KMS", "SSE-C", "Client-side encryption"], answer: 1, explain: "SSE-KMS provides encryption with CloudTrail audit trail showing when and who used the key." },
      { cat: "design-secure", q: "Control maximum permissions developers can grant?", options: ["IAM groups", "Permissions boundary", "Resource policies", "SCPs only"], answer: 1, explain: "Permissions boundaries set maximum permissions that IAM principals can have." },
      { cat: "design-secure", q: "WAF on ALB blocks traffic from which countries?", options: ["Any country via geo match", "USA only", "Cannot block by country", "Requires CloudFront"], answer: 0, explain: "AWS WAF geo match conditions can block or allow traffic based on country of origin." },
      { cat: "design-secure", q: "Delegate cross-account access without sharing credentials?", options: ["Share IAM user", "IAM role with trust policy", "Same root account", "VPC peering"], answer: 1, explain: "IAM roles with cross-account trust policies allow secure temporary access via AssumeRole." },
      { cat: "design-secure", q: "IAM best practices for CloudTrail?", options: ["Disable logging", "Log all IAM actions", "Log root only", "Weekly logging"], answer: 1, explain: "Enable CloudTrail to log all IAM actions for auditing and monitoring." },
      { cat: "design-secure", q: "S3 DeleteObject permission - correct resource ARN?", options: ["arn:aws:s3:::bucket", "arn:aws:s3:::bucket/*", "arn:aws:s3:::bucket*", "arn:aws:s3:::*"], answer: 1, explain: "Object-level permissions require bucket/* ARN format, not just the bucket ARN." },
      { cat: "design-secure", q: "Private DNS resolution from VPC to on-premises?", options: ["Route 53 inbound endpoint", "Route 53 outbound endpoint with forwarding rule", "Private hosted zone", "Hybrid gateway"], answer: 1, explain: "Outbound endpoint forwards DNS queries from VPC to on-premises DNS servers." },
      { cat: "design-secure", q: "Connect to partner's RDS privately without internet?", options: ["VPC peering", "NLB + PrivateLink endpoint", "Public RDS + security group", "Client VPN"], answer: 1, explain: "Partner creates NLB in front of RDS, exposes via PrivateLink. Company uses interface endpoint." },
      { cat: "design-secure", q: "EKS Pod-level permissions following least privilege?", options: ["EC2 instance profile for all", "IRSA with separate service accounts", "Single shared service account", "Kubernetes RBAC only"], answer: 1, explain: "IAM Roles for Service Accounts (IRSA) provides fine-grained Pod-level IAM permissions." },
      { cat: "design-secure", q: "Centrally manage access for developers across AWS accounts with on-prem AD?", options: ["AWS Managed AD", "AD Connector + IAM Identity Center", "Custom IdP on EC2", "Control Tower only"], answer: 1, explain: "AD Connector proxies to on-prem AD. IAM Identity Center provides SSO with permission sets." },
      { cat: "design-secure", q: "Monitor S3 for malicious activity, EC2 for vulnerabilities?", options: ["Inspector for both", "GuardDuty for both", "GuardDuty for S3, Inspector for EC2", "Macie for both"], answer: 2, explain: "GuardDuty monitors threats across S3/accounts. Inspector scans EC2 for vulnerabilities." },
      { cat: "design-secure", q: "EFS access control for EC2 instances?", options: ["Security groups + IAM policies", "NACLs only", "GuardDuty", "S3 bucket policies"], answer: 0, explain: "Use VPC security groups for network control and IAM policies for file system permissions." },
      { cat: "design-secure", q: "Run Kubernetes on-premises with AWS APIs but all data local?", options: ["EKS in cloud", "EKS Anywhere on Outposts", "EKS with Direct Connect", "Snowball Edge"], answer: 1, explain: "AWS Outposts Rack with EKS Anywhere runs Kubernetes on-premises with AWS integration." },

      // Design High-Performing Architectures
      { cat: "design-performant", q: "Faster S3 uploads across continents?", options: ["CloudFront", "S3 Transfer Acceleration + Multipart", "Direct Connect", "VPN"], answer: 1, explain: "S3 Transfer Acceleration uses edge locations. Multipart upload enables parallel transfers." },
      { cat: "design-performant", q: "2GB file upload to S3 - fastest method?", options: ["Single PUT", "Multipart + S3TA", "FTP to EC2 first", "Multipart only"], answer: 1, explain: "Combine multipart upload with Transfer Acceleration for fastest uploads over long distances." },
      { cat: "design-performant", q: "Microsoft DFS migration to AWS?", options: ["FSx for Lustre", "FSx for Windows File Server", "AWS Managed AD", "SQL Server on AWS"], answer: 1, explain: "FSx for Windows supports DFS for organizing shares into folder structures up to hundreds of PB." },
      { cat: "design-performant", q: "Global UDP application with fast regional failover?", options: ["Route 53", "CloudFront", "AWS Global Accelerator", "ELB"], answer: 2, explain: "Global Accelerator supports TCP/UDP, provides static IPs, and fast regional failover." },
      { cat: "design-performant", q: "On-premises dynamic website for Asia users, backend in US?", options: ["S3 + CRR", "CloudFront with custom origin to on-prem", "Route 53 geo-proximity", "CloudFront with Route 53 DNS origin"], answer: 1, explain: "CloudFront caches at edge locations near users, custom origin points to on-premises servers." },
      { cat: "design-performant", q: "Extract ingredients from text files without ML expertise?", options: ["SageMaker custom model", "Amazon Comprehend custom entity recognition", "Amazon Transcribe", "Lookout for Vision"], answer: 1, explain: "Comprehend's custom entity recognition extracts entities from text without ML expertise." },
      { cat: "design-performant", q: "REST API for real-time location analytics?", options: ["API Gateway + Lambda", "API Gateway + Kinesis Data Analytics", "Athena + S3", "QuickSight + Redshift"], answer: 1, explain: "API Gateway receives requests, Kinesis Data Analytics processes real-time streaming data." },
      { cat: "design-performant", q: "Database timeouts during peak - serverless scaling solution?", options: ["Manual EC2 scaling", "RDS Proxy + SQS + Auto Scaling workers", "Larger RDS instance", "Aurora Serverless only"], answer: 1, explain: "RDS Proxy handles connection pooling. SQS decouples. Auto Scaling handles worker capacity." },
      { cat: "design-performant", q: "High random I/O for HPC with replicated data across fleet?", options: ["EBS io2", "Instance Store", "EFS", "S3"], answer: 1, explain: "Instance Store provides high I/O at no extra cost; data replicated by application handles failures." },
      { cat: "design-performant", q: "FSx for Lustre use case?", options: ["Windows file shares", "HPC and ML workloads", "DFS support", "Microsoft AD"], answer: 1, explain: "FSx for Lustre provides sub-millisecond latency for HPC, ML, and video processing." },
      { cat: "design-performant", q: "S3 bucket with 5000+ req/sec hitting scalability issues?", options: ["Use bigger bucket", "Create customer-specific prefixes", "One bucket per customer", "One bucket per day"], answer: 1, explain: "S3 supports 3,500 PUT and 5,500 GET per prefix. Use prefixes to parallelize and scale." },
      { cat: "design-performant", q: "EC2 placement for low-latency HPC?", options: ["Spread placement group", "Partition placement group", "Cluster placement group", "Auto Scaling group"], answer: 2, explain: "Cluster placement groups pack instances close together for low-latency, high-throughput HPC." },
      { cat: "design-performant", q: "EFS shared across regions?", options: ["Not possible", "Inter-region VPC peering", "EFS replication only", "S3 required"], answer: 1, explain: "EFS can be accessed across regions using inter-region VPC peering connections." },
      { cat: "design-performant", q: "AMI copied to Region B creates what in Region B?", options: ["Just AMI", "Just snapshot", "EC2 + AMI", "EC2 + AMI + snapshot"], answer: 3, explain: "AMI copy creates the AMI and underlying snapshot. Launching creates the EC2 instance." },
      { cat: "design-performant", q: "API Gateway stateless vs stateful APIs?", options: ["Both RESTful are stateful", "REST stateless, WebSocket stateful", "Both are stateless", "Both are stateful"], answer: 1, explain: "RESTful APIs are stateless. WebSocket APIs are stateful with full-duplex communication." },
      { cat: "design-performant", q: "EBS volume types that CANNOT be boot volumes?", options: ["gp2 and io1", "st1 and sc1", "gp3 and io2", "All can be boot"], answer: 1, explain: "HDD types (st1 Throughput Optimized, sc1 Cold HDD) cannot be used as boot volumes." },
      { cat: "design-performant", q: "Migrate SQL Server T-SQL to Aurora PostgreSQL with minimal refactoring?", options: ["AWS DMS only", "Babelfish for Aurora PostgreSQL + SCT/DMS", "FSx for Windows", "Manual query rewrite"], answer: 1, explain: "Babelfish enables Aurora PostgreSQL to understand T-SQL. SCT converts schema, DMS migrates data." },
      { cat: "design-performant", q: "In-memory leaderboard for gaming - which services?", options: ["DynamoDB only", "ElastiCache Redis or DynamoDB with DAX", "RDS Aurora", "Neptune"], answer: 1, explain: "ElastiCache Redis provides in-memory data store. DAX provides in-memory caching for DynamoDB." },
      { cat: "design-performant", q: "SQL-based ML in data warehouse without Python?", options: ["Athena ML", "Redshift ML", "RDS ML", "SageMaker only"], answer: 1, explain: "Amazon Redshift ML allows creating, training, and deploying ML models using SQL." },
      { cat: "design-performant", q: "Long-running container tasks with serverless compute?", options: ["Lambda", "ECS with Fargate", "EC2 only", "Lightsail"], answer: 1, explain: "ECS with Fargate provides serverless container compute without managing infrastructure." },
      { cat: "design-performant", q: "Dedicated encrypted low-latency high-throughput connection to AWS?", options: ["Site-to-Site VPN", "Direct Connect + VPN", "Transit Gateway only", "Direct Connect only"], answer: 1, explain: "Direct Connect provides dedicated low-latency connection. Adding VPN provides encryption." },

      // Design Cost-Optimized Architectures
      { cat: "design-cost", q: "Access S3 from Lambda in Account A to EFS in Account B privately?", options: ["S3 bucket in partner account", "EFS resource policy + VPC peering/endpoint", "Lambda layer", "Proxy Lambda"], answer: 1, explain: "EFS resource policies allow cross-account access. Mount via shared VPC or peered VPC." },
      { cat: "design-cost", q: "S3 invalid lifecycle transitions?", options: ["Standard to Intelligent-Tiering", "Intelligent-Tiering to Standard", "Standard-IA to One Zone-IA", "Standard to Glacier"], answer: 1, explain: "Cannot transition TO Standard or Reduced Redundancy. Cannot go from One Zone-IA to Standard-IA." },
      { cat: "design-cost", q: "Re-creatable assets accessed occasionally after first week?", options: ["S3 Standard", "S3 One Zone-IA after 30 days", "S3 Standard-IA after 7 days", "Glacier immediately"], answer: 1, explain: "One Zone-IA is 20% cheaper than Standard-IA. 30-day minimum before lifecycle transition." },
      { cat: "design-cost", q: "Intermediary query results kept 24 hours, heavily referenced?", options: ["S3 Standard", "S3 Standard-IA", "S3 One Zone-IA", "Glacier Instant Retrieval"], answer: 0, explain: "S3 Standard has no minimum duration charge or retrieval fees - cheapest for short-term, frequently accessed data." },
      { cat: "design-cost", q: "60-minute workflow that can be interrupted - most cost-effective?", options: ["On-Demand EC2", "Spot Instances", "Reserved Instances", "Lambda"], answer: 1, explain: "Spot Instances offer up to 90% discount for fault-tolerant, interruptible workloads." },
      { cat: "design-cost", q: "ECS pricing: EC2 launch type vs Fargate?", options: ["Both by vCPU/memory", "Both by EC2/EBS", "EC2 by resources, Fargate by vCPU/memory", "Fargate free"], answer: 2, explain: "EC2 launch type: pay for EC2/EBS. Fargate: pay for vCPU and memory requested by containers." },
      { cat: "design-cost", q: "Hybrid NFS storage with automated tiering to lower-cost classes?", options: ["EFS with lifecycle", "Storage Gateway File Gateway + S3 lifecycle", "Volume Gateway", "FSx for Windows"], answer: 1, explain: "File Gateway presents NFS interface, stores in S3. S3 lifecycle policies tier to cheaper classes." },
      { cat: "design-cost", q: "1GB file storage cost comparison: S3 vs EFS vs EBS 100GB?", options: ["EBS < S3 < EFS", "S3 < EFS < EBS", "EFS < S3 < EBS", "S3 < EBS < EFS"], answer: 1, explain: "S3: ~$0.023/GB. EFS: ~$0.30/GB. EBS gp2 100GB provisioned: $10/month regardless of usage." },
      { cat: "design-cost", q: "S3TA upload didn't accelerate - what's charged?", options: ["Both S3 and S3TA charges", "Only S3TA charges", "Only S3 charges", "No charges (data in is free)"], answer: 3, explain: "Data transfer IN to S3 is free. S3TA only charges when acceleration occurs." },
      { cat: "design-cost", q: "CloudFront vs direct S3 for static content delivery?", options: ["S3 always cheaper", "CloudFront typically more cost-effective", "Same cost", "CloudFront only for video"], answer: 1, explain: "CloudFront can be more cost-effective due to caching, reduced S3 requests, and lower data transfer rates." },

      // Practice Test #4 - 65 Questions
      { cat: "design-performant", q: "Recommended solution to incorporate RDS best practices into reusable infrastructure?", options: ["Store recommendations in custom Trusted Advisor rule", "Use CloudFormation to manage RDS databases", "Create Lambda function to send emails for misconfigured RDS", "Attach IAM policy to prevent RDS creation"], answer: 1, explain: "CloudFormation provides reusable infrastructure templates with configuration parameters for RDS best practices." },
      { cat: "design-cost", q: "Auto Scaling with predictable patterns and real-time spikes - best strategy?", options: ["Simple scaling with longer cooldowns", "Predictive scaling + dynamic scaling with target tracking", "Scheduled scaling with manual adjustments", "Step scaling based on CPU"], answer: 1, explain: "Predictive scaling forecasts demand using ML. Combined with dynamic target tracking, it handles both patterns and real-time spikes." },
      { cat: "design-cost", q: "Reduce Aurora costs with read-heavy workload, acceptable 24h stale data?", options: ["Enable Lambda In Memory Caching", "Enable API Gateway Caching", "Switch to ALB", "Add Aurora Read Replicas"], answer: 1, explain: "API Gateway caching reduces Aurora calls by caching endpoint responses for up to 24 hours TTL." },
      { cat: "design-resilient", q: "Asynchronously decouple SaaS and third-party integrations?", options: ["Use SNS to communicate between systems", "Use SQS to decouple", "Use EventBridge to decouple", "Use ELB for decoupling"], answer: 2, explain: "EventBridge integrates directly with third-party SaaS partners and AWS services for event-driven architecture." },
      { cat: "design-secure", q: "Only resource-based policy IAM supports?", options: ["Permissions boundary", "Organizations SCP", "Access control list (ACL)", "Trust policy"], answer: 3, explain: "Trust policy is the only resource-based policy for IAM roles, defining which principals can assume the role." },
      { cat: "design-resilient", q: "Most cost-effective to connect VPCs across employees?", options: ["Use Internet Gateway", "Use VPC peering connection", "Use Direct Connect", "Use NAT gateway"], answer: 1, explain: "VPC peering connects VPCs privately without internet gateway, Direct Connect, or NAT gateway costs." },
      { cat: "design-cost", q: "EFS burst throughput for sporadic spikes with low average demand?", options: ["Switch to EFS One Zone", "Enable EFS IA storage class", "Change to provisioned throughput", "Enable burst mode with General Purpose and Standard"], answer: 3, explain: "Burst throughput mode accumulates credits for spikes without manual provisioning, ideal for unpredictable workloads." },
      { cat: "design-performant", q: "Scale infrastructure for 10x flash sale traffic with dynamic content?", options: ["Deploy on S3", "Use CloudFront distribution", "Use Route 53 Multi Value", "Use Auto Scaling Group"], answer: 3, explain: "Auto Scaling Group automatically adjusts EC2 capacity for traffic spikes with dynamic content." },
      { cat: "design-resilient", q: "Robust DR for ElastiCache Redis with minimal downtime and data loss?", options: ["Add read-replicas across AZs", "Schedule daily automatic backups", "Schedule manual backups using AOF", "Multi-AZ with automatic failover"], answer: 3, explain: "Multi-AZ provides automatic failover with low data loss and minimal downtime for Redis." },
      { cat: "design-secure", q: "Two AWS services using Gateway Endpoints? (Select two)", options: ["DynamoDB", "Kinesis", "SNS", "S3", "SQS"], answer: 0, explain: "Only S3 and DynamoDB use Gateway Endpoints. Other services use Interface Endpoints." },
      { cat: "design-performant", q: "Maximize VPN throughput across regions?", options: ["Create virtual private gateway with ECMP", "Use Global Accelerator for VPN", "Create Transit Gateway with ECMP and add VPN tunnels", "Use Transfer Acceleration for VPN"], answer: 2, explain: "Transit Gateway with ECMP enables scaling VPN throughput beyond 1.25 Gbps using multiple tunnels." },
      { cat: "design-performant", q: "Route 53 feature to dynamically alter geographic routing area?", options: ["Weighted routing", "Geoproximity routing", "Geolocation routing", "Latency-based routing"], answer: 1, explain: "Geoproximity routing with bias lets you expand or shrink geographic regions routing traffic to resources." },
      { cat: "design-secure", q: "CloudFormation snippet security group rules analysis? (Select three)", options: ["Lets traffic from one IP on port 22", "Configures outbound rules", "Only allows 0.0.0.0 to HTTP", "Prevents traffic unless from 192.168.1.1", "Configures network ACL inbound", "Allows any IP on HTTP", "Configures security group inbound"], answer: 0, explain: "SecurityGroupIngress configures inbound rules allowing any IP on port 80 and one IP (192.168.1.1) on port 22." },
      { cat: "design-resilient", q: "Reduce time to create Elastic Beanstalk instance from 45 min to under 2 min? (Select two)", options: ["Use EC2 user data to install at boot", "Use EC2 user data to customize dynamic parts at boot", "Store files in S3 for retrieval", "Use Elastic Beanstalk deployment caching", "Create Golden AMI with static components"], answer: 1, explain: "Golden AMI with static components + EC2 user data for dynamic customization minimizes deployment time." },
      { cat: "design-performant", q: "Niche social media app with DynamoDB hot partition - improve performance without refactoring?", options: ["Use ElastiCache", "Use DynamoDB Streams", "Use Global Tables", "Use DynamoDB DAX"], answer: 3, explain: "DAX provides microsecond latency in-memory cache for DynamoDB, eliminating hot partition issues transparently." },
      { cat: "design-resilient", q: "Serverless NoSQL database with single-digit ms latency for ride GPS tracking?", options: ["RDS", "DynamoDB", "Neptune", "ElastiCache"], answer: 1, explain: "DynamoDB provides single-digit millisecond performance, serverless, and horizontal scaling for high-frequency lookups." },
      { cat: "design-resilient", q: "45-min install, RTO 5 min in multiple regions - DR strategy?", options: ["Use EC2 user data", "Store files in S3", "Create AMI and use in other regions", "Create AMI and copy across all regions"], answer: 3, explain: "AMI with pre-installed software copied to all regions enables fast 5-minute recovery across regions." },
      { cat: "design-performant", q: "Move petabytes of tape data to cloud cost-effectively?", options: ["Tape Gateway to move data, then S3 archiving classes", "VPN + EFS for NFS file system", "DataSync to move data to S3", "Direct Connect to transfer to S3"], answer: 0, explain: "Tape Gateway moves tape data to cloud without changing workflows, stores in S3 Glacier cost-effectively." },
      { cat: "design-performant", q: "Managed message broker supporting MQTT protocol?", options: ["Amazon MQ", "Kinesis Data Streams", "SNS", "SQS"], answer: 0, explain: "Amazon MQ supports MQTT, AMQP, STOMP and other messaging protocols for existing applications." },
      { cat: "design-secure", q: "Dedicated private on-prem to AWS connection with encrypted failover? (Select two)", options: ["Site-to-Site VPN as backup", "Direct Connect as primary", "Direct Connect as backup", "Egress Only IGW as backup", "Site-to-Site VPN as primary"], answer: 1, explain: "Direct Connect provides dedicated private connection. Site-to-Site VPN over internet as encrypted backup." },
      { cat: "design-performant", q: "Database for social networking queries like friends who liked videos?", options: ["Neptune", "Redshift", "Aurora", "OpenSearch"], answer: 0, explain: "Neptune is purpose-built graph database for highly connected datasets like social networks." },
      { cat: "design-performant", q: "Connect VPCs and on-prem with least overhead?", options: ["Use Internet Gateway", "Use VPC peering", "Use Direct Connect", "Use Transit Gateway"], answer: 3, explain: "Transit Gateway acts as central hub connecting VPCs and on-premises with single connection point." },
      { cat: "design-cost", q: "Real-time location tracking with frequent RDS reads - reduce read pressure cost-effectively?", options: ["Enable Aurora Serverless v2", "Convert to multi-writer Aurora global", "Integrate ElastiCache Redis for caching", "Add another Aurora read replica"], answer: 2, explain: "ElastiCache Redis caches frequently accessed queries in-memory, reducing repeated RDS reads cost-effectively." },
      { cat: "design-performant", q: "ALB with inconsistent traffic - most scalable solution for firewall IP whitelisting?", options: ["Set up Global Accelerator with ALB, allow static IPs", "Set up NLB in one region with ALB private IPs", "Migrate ALB to NLB in all regions", "Use Lambda to get ALB IPs for firewall"], answer: 0, explain: "Global Accelerator provides two static IPs for ALB endpoints, simplifying firewall configuration globally." },
      { cat: "design-secure", q: "ALB unhealthy instances but accessible via IP - troubleshoot? (Select two)", options: ["Check route table configured with IGW", "Contact AWS support", "Disable Source/Destination check", "Create secondary IGW", "Check security groups allow ping"], answer: 0, explain: "Verify route table has IGW route and security groups allow traffic on health check port." },
      { cat: "design-secure", q: "Enforce 7-year immutable transaction records and 10-year archived compliance data?", options: ["Use Object Lock Governance mode for both", "Use Glacier Vault Lock for both", "Use S3 Standard with Lifecycle for Policy A, Glacier for B", "Use Object Lock Compliance mode for A, Glacier Vault Lock for B"], answer: 3, explain: "Object Lock Compliance mode ensures immutable audit-ready data. Glacier Vault Lock for long-term archived compliance." },
      { cat: "design-performant", q: "EFS mount targets for EC2 across AZs with lowest latency?", options: ["Create mount targets on EC2 in each AZ", "Create EFS mount targets in each AZ", "Use Mountpoint for S3", "Create single mount target in one AZ"], answer: 1, explain: "Mount targets in each AZ ensure EC2 instances access EFS locally within same AZ for lowest latency." },
      { cat: "design-secure", q: "Security group for EC2 instances to only allow ALB traffic?", options: ["Add rule to authorize ALB security group", "Add rule for CIDR 10.0.4.0/22", "Add rule for CIDR 10.0.1.0/24", "Add rule for ASG security group"], answer: 0, explain: "Security group rules can reference another security group, allowing only ALB traffic to EC2 instances." },
      { cat: "design-resilient", q: "DR strategy with scaled-down environment always running in cloud?", options: ["Backup and Restore", "Multi Site", "Warm Standby", "Pilot Light"], answer: 2, explain: "Warm Standby runs scaled-down version of full environment, enabling quick scale-up during disaster." },
      { cat: "design-resilient", q: "ALB host-based routing - *.example.com matches which domain?", options: ["example.test.com", "EXAMPLE.COM", "example.com", "test.example.com"], answer: 3, explain: "*.example.com matches subdomains like test.example.com but not the apex domain example.com." },
      { cat: "design-performant", q: "HPC workload needing high network throughput and low latency?", options: ["Select capacity reservation", "Select cluster placement group", "Select dedicated instance tenancy", "Select Elastic Inference accelerator"], answer: 1, explain: "Cluster placement group packs instances close together for low-latency node-to-node HPC communication." },
      { cat: "design-resilient", q: "Migrate on-prem SQL Server to AWS with maximum availability, minimal overhead?", options: ["Migrate to RDS SQL Server Multi-AZ", "Migrate to EC2 SQL Server Multi-AZ", "Migrate to RDS cross-region Multi-AZ", "Migrate to RDS cross-region read-replica"], answer: 0, explain: "RDS SQL Server Multi-AZ provides automatic failover with minimal operational overhead." },
      { cat: "design-resilient", q: "DynamoDB table with unpredictable spikes that happen quickly - capacity mode?", options: ["On-demand capacity mode", "With global secondary index", "Global table in provisioned mode", "Provisioned with auto-scaling"], answer: 0, explain: "On-demand mode handles unpredictable traffic and quick spikes without capacity planning." },
      { cat: "design-resilient", q: "Prevent future accidental DynamoDB table deletion with minimal overhead?", options: ["Enable point-in-time recovery (PITR)", "Configure CloudTrail + EventBridge + Lambda recovery", "Export to S3 weekly", "Enable deletion protection"], answer: 3, explain: "Deletion protection prevents accidental table deletion proactively with zero operational overhead." },
      { cat: "design-performant", q: "Stream S3 data to Kinesis Data Streams fastest way?", options: ["S3 bucket actions to SNS then Kinesis", "EventBridge events trigger Lambda to Kinesis", "S3 event notification trigger Lambda to Kinesis", "Use DMS as bridge between S3 and Kinesis"], answer: 3, explain: "AWS DMS supports S3 source and Kinesis target, streaming full and CDC files out-of-box without code." },
      { cat: "design-resilient", q: "Route 53 update not redirecting to new Load Balancer - what's wrong?", options: ["Health checks failing", "CNAME Record misconfigured", "Alias Record misconfigured", "TTL still in effect"], answer: 3, explain: "DNS TTL must expire before recursive resolvers query for new Load Balancer address." },
      { cat: "design-performant", q: "Route 53 with 2 NLB nodes (AZ-A: 4 targets, AZ-B: 6 targets), cross-zone disabled - AZ-A traffic distribution?", options: ["Each AZ-A target gets 10%", "Each AZ-B target gets 10%", "Each AZ-A target gets 12.5%", "Each AZ-A target gets 8%"], answer: 2, explain: "Route 53 sends 50% to each NLB node. Without cross-zone, AZ-A's 50% splits across 4 targets = 12.5% each." },
      { cat: "design-performant", q: "Real-time API for streaming analytics from S3 to Kinesis?", options: ["API Gateway + Lambda", "API Gateway + Kinesis Data Analytics", "Athena + S3", "QuickSight + Redshift"], answer: 1, explain: "API Gateway receives requests, Kinesis Data Analytics processes streaming data in real-time." },
      { cat: "design-cost", q: "Cost optimization: EC2 idle/low utilization and instance type recommendations?", options: ["Use Compute Optimizer for purchasing options", "Use Cost Optimization Hub for idle instances + Compute Optimizer for types", "Use Trusted Advisor for auto-renew RI", "Use S3 Storage class analysis with Lifecycle"], answer: 1, explain: "Cost Optimization Hub identifies idle/underutilized resources. Compute Optimizer recommends optimal instance types." },
      { cat: "design-resilient", q: "Bank requirement for whitelisted public IP with high availability?", options: ["Use ALB with Auto Scaling", "Use Classic LB with Auto Scaling", "Use NLB with Auto Scaling", "Use ASG with Dynamic EIPs"], answer: 2, explain: "Network Load Balancer exposes fixed IP addresses that can be whitelisted by bank firewalls." },
      { cat: "design-cost", q: "One-time S3 cross-region copy of 1 PB data? (Select two)", options: ["Use Snowball Edge", "Copy via S3 console", "Set up S3 batch replication then delete config", "Set up S3 Transfer Acceleration", "Use aws s3 sync command"], answer: 2, explain: "S3 batch replication for existing objects one-time copy. AWS S3 sync command for large data transfers." },
      { cat: "design-secure", q: "Centralized SSO with on-prem AD across AWS accounts?", options: ["AWS Managed AD", "AD Connector + IAM Identity Center", "Custom IdP on EC2", "Control Tower only"], answer: 1, explain: "AD Connector proxies to on-prem AD. IAM Identity Center provides centralized SSO with permission sets." },
      { cat: "design-resilient", q: "ASG cross-AZ rebalancing - how does it work?", options: ["Terminates first, then launches", "Launches first, then terminates", "Simultaneous", "Manual intervention"], answer: 1, explain: "ASG launches new instances before terminating old ones during rebalancing to maintain availability." },
      { cat: "design-resilient", q: "Decouple architecture with ALB and Auto Scaling - which scaling strategy? (Select two)", options: ["Set minimum capacity to 2", "Use RIs for minimum capacity", "Use Dedicated hosts", "Set minimum to 3", "Set minimum to 1"], answer: 0, explain: "Minimum 2 instances across different AZs ensures high availability. RIs for minimum capacity reduce costs." },
      { cat: "design-cost", q: "S3 lifecycle - optimize costs for images (45 days) vs thumbnails? (Select two)", options: ["Transition all to Standard IA after 45 days", "Transition all to Glacier after 180 days", "Transition to One Zone IA with prefix after 45 days", "Transition to Standard IA with prefix after 45 days", "Transition to Glacier with prefix after 180 days"], answer: 1, explain: "Use prefix to transition only images to Standard IA after 45 days. All objects to Glacier after 180 days." },
      { cat: "design-performant", q: "Serverless high-traffic API - Lambda chaining choices? (Select three)", options: ["Field level encryption for sensitive data", "CloudFront can route to multiple origins by price class", "Origin group with primary/secondary for failover", "CloudFront routes to origins by content type", "Geo restriction for high availability", "Use KMS encryption in CloudFront"], answer: 0, explain: "CloudFront routes by content type, uses origin groups for failover, and field-level encryption for sensitive data." },
      { cat: "design-cost", q: "io1 volume is 90% of cost, both EC2 and EBS under-utilized with occasional bursts?", options: ["Change EC2 to smaller type", "Convert EBS to gp2", "Don't use CloudFormation", "Keep io1 and reduce IOPS"], answer: 1, explain: "gp2 volumes are cost-effective and support bursting, perfect for occasional I/O spikes." },
      { cat: "design-resilient", q: "Container orchestration serverless solutions? (Select two)", options: ["Use EMR", "Use SageMaker", "Use EKS with Fargate", "Use ECS with Fargate", "Use ECS with EC2"], answer: 2, explain: "EKS and ECS with Fargate provide serverless container orchestration without managing EC2 instances." },
      { cat: "design-secure", q: "Grant S3 bucket access to users in own and another AWS account?", options: ["Use bucket policy or user policy for both", "Use permissions boundary", "Use user policy for both", "Use bucket policy for both"], answer: 3, explain: "Bucket policy is the only way to grant cross-account access to S3 buckets." },
      { cat: "design-performant", q: "Aurora I/O-Optimized vs other storage for high I/O spikes?", options: ["Deploy cached volumes with Storage Gateway", "Implement FSx for Windows over VPN", "Set up S3 Standard-IA with DataSync", "Deploy stored volumes with Storage Gateway"], answer: 0, explain: "Aurora I/O-Optimized provides high throughput with predictable pricing and no I/O-based charges for I/O-intensive apps." },
      { cat: "design-cost", q: "Healthcare hybrid storage with frequent access and no retrieval fees?", options: ["Deploy cached volumes with Storage Gateway", "Implement FSx for Windows", "Set up S3 Standard-IA", "Deploy stored volumes"], answer: 0, explain: "Storage Gateway cached volumes store frequently accessed data locally, all data in S3 without retrieval fees." },
      { cat: "design-resilient", q: "EKS node autoscaling when pod demand exceeds capacity?", options: ["Enable EC2 Auto Scaling with CloudWatch alarms", "Deploy Cluster Autoscaler to integrate with ASG", "Use Fargate to replace nodes", "Implement Lambda function for manual scaling"], answer: 1, explain: "Kubernetes Cluster Autoscaler monitors pending pods and automatically adjusts node count via ASG." },
      { cat: "design-secure", q: "Improve Lambda to RDS PostgreSQL authentication with short-lived credentials? (Select two)", options: ["Deploy Lambda in VPC", "Attach IAM role to Lambda", "Embed credential rotation in Lambda from SSM", "Use IAM authentication to RDS", "Restrict RDS security group to Lambda"], answer: 1, explain: "IAM authentication to RDS PostgreSQL uses IAM roles attached to Lambda for short-lived tokens instead of passwords." },
      { cat: "design-cost", q: "Compress images asynchronously with retries, minimize cost? (Select two)", options: ["SQS", "EC2 On-Demand", "EC2 RIs", "SNS", "EC2 Spot Instances"], answer: 0, explain: "SQS for async job queue with retries. Spot Instances for cost-effective compute for interruptible workloads." },
      { cat: "design-secure", q: "SNI use case for multiple secure domains on ALB?", options: ["Use SNI", "Use wildcard SSL certificate", "Change ELB SSL Security Policy", "Use HTTP to HTTPS redirect"], answer: 0, explain: "SNI allows multiple TLS certificates on same ALB listener for different domains like checkout.mycorp.com and www.mycorp.com." },
      { cat: "design-cost", q: "Archive years of data encrypted at rest with automatic annual key rotation?", options: ["Client-side encryption with imported KMS key", "SSE-S3 with built-in rotation", "CloudHSM with manual workflow", "Customer managed KMS key with automatic rotation + S3 default encryption"], answer: 3, explain: "Customer managed KMS key with auto rotation and S3 default encryption meets compliance with annual rotation." },
      { cat: "design-resilient", q: "1TB file multi-part upload to S3?", options: ["Use S3 Versioning", "Use multi-part upload", "Use Snowball", "Use Direct Connect"], answer: 1, explain: "Multi-part upload required for files >5GB, recommended for >100MB for resiliency and performance." },
      { cat: "design-secure", q: "Hybrid global expansion with Direct Connect - connect both regions and on-prem?", options: ["Establish inter-Region VPC peering", "Deploy EC2 VPN mesh", "Create private VIFs with foreign-region VPCs", "Connect both DX links to shared DX gateway"], answer: 3, explain: "Direct Connect gateway enables VPCs in multiple regions to connect to on-premises via single DX gateway." },
      { cat: "design-secure", q: "Configure RDS to encrypt data in transit?", options: ["Create security group blocking SSH", "Use IAM authentication instead of password", "Create network ACL blocking SSH", "Configure RDS to use SSL"], answer: 3, explain: "SSL/TLS encrypts data in transit between applications and RDS PostgreSQL database." },
      { cat: "design-performant", q: "Stream S3 data to Kinesis then analyze with Lambda - architecture?", options: ["SQS to capture, Lambda to analyze", "Kinesis Data Streams to capture, Kinesis Data Analytics to analyze, Firehose to persist", "Kinesis to capture, Firehose to persist, Athena to analyze", "Kinesis to capture, QuickSight to analyze, Firehose to persist"], answer: 1, explain: "Kinesis Data Streams captures data, Kinesis Data Analytics analyzes in real-time, Firehose persists to S3." }
    ];

    // AWS Services Reference
    const awsServices = [
      { name: "EC2", desc: "Virtual servers in the cloud", cat: "Compute" },
      { name: "Lambda", desc: "Serverless compute - run code without servers", cat: "Compute" },
      { name: "ECS/EKS", desc: "Container orchestration (Docker/Kubernetes)", cat: "Compute" },
      { name: "Fargate", desc: "Serverless containers", cat: "Compute" },
      { name: "S3", desc: "Object storage with 11 9s durability", cat: "Storage" },
      { name: "EBS", desc: "Block storage for EC2 instances", cat: "Storage" },
      { name: "EFS", desc: "Managed NFS file system", cat: "Storage" },
      { name: "Glacier", desc: "Low-cost archive storage", cat: "Storage" },
      { name: "RDS", desc: "Managed relational databases", cat: "Database" },
      { name: "Aurora", desc: "High-performance MySQL/PostgreSQL compatible", cat: "Database" },
      { name: "DynamoDB", desc: "NoSQL key-value with single-digit ms latency", cat: "Database" },
      { name: "ElastiCache", desc: "In-memory caching (Redis/Memcached)", cat: "Database" },
      { name: "Redshift", desc: "Data warehouse for analytics", cat: "Database" },
      { name: "VPC", desc: "Isolated virtual network", cat: "Networking" },
      { name: "CloudFront", desc: "Content delivery network (CDN)", cat: "Networking" },
      { name: "Route 53", desc: "DNS and domain registration", cat: "Networking" },
      { name: "API Gateway", desc: "Create and manage APIs", cat: "Networking" },
      { name: "Direct Connect", desc: "Dedicated network to AWS", cat: "Networking" },
      { name: "ELB", desc: "Load balancing across targets", cat: "Networking" },
      { name: "IAM", desc: "Identity and access management", cat: "Security" },
      { name: "KMS", desc: "Encryption key management", cat: "Security" },
      { name: "Shield", desc: "DDoS protection", cat: "Security" },
      { name: "WAF", desc: "Web application firewall", cat: "Security" },
      { name: "GuardDuty", desc: "Threat detection with ML", cat: "Security" },
      { name: "CloudWatch", desc: "Monitoring and observability", cat: "Management" },
      { name: "CloudTrail", desc: "API activity logging", cat: "Management" },
      { name: "Config", desc: "Resource configuration tracking", cat: "Management" },
      { name: "SQS", desc: "Message queuing service", cat: "Integration" },
      { name: "SNS", desc: "Pub/sub messaging", cat: "Integration" },
      { name: "EventBridge", desc: "Event bus for applications", cat: "Integration" }
    ];

    // State
    let currentCert = DB.getOne('currentCert') || 'clf';
    let currentCategory = 'all';
    let questions = currentCert === 'clf' ? clfQuestions : saaQuestions;
    let filteredQuestions = [...questions];
    let currentQuestionIndex = 0;
    let quizStats = DB.getOne('quizStats_' + currentCert) || { correct: 0, total: 0, bestStreak: 0, currentStreak: 0, byCategory: {} };
    let answeredQuestions = DB.get('answeredQuestions_' + currentCert) || [];

    // Exam State
    let examQuestions = [];
    let examIndex = 0;
    let examAnswers = [];
    let examTimer = null;
    let examTimeLeft = 0;

    function shuffleArray(arr) {
      for (let i = arr.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [arr[i], arr[j]] = [arr[j], arr[i]];
      }
    }

    function switchCert() {
      currentCert = document.getElementById('certSelector').value;
      DB.setOne('currentCert', currentCert);
      questions = currentCert === 'clf' ? clfQuestions : saaQuestions;
      quizStats = DB.getOne('quizStats_' + currentCert) || { correct: 0, total: 0, bestStreak: 0, currentStreak: 0, byCategory: {} };
      answeredQuestions = DB.get('answeredQuestions_' + currentCert) || [];
      filteredQuestions = [...questions];
      shuffleArray(filteredQuestions);
      currentQuestionIndex = 0;
      currentCategory = 'all';
      updateUI();
      loadQuestion();
    }

    function updateUI() {
      const cert = certifications[currentCert];
      document.getElementById('currentCertName').textContent = cert.name;
      document.getElementById('certBadge').textContent = cert.code;
      document.getElementById('certBadge').className = 'cert-badge ' + currentCert;
      document.getElementById('passScore').textContent = cert.passScore + '%';
      document.getElementById('examQuestions').textContent = cert.questions;
      document.getElementById('examTime').textContent = cert.time + ' min';
      document.getElementById('quizCertTitle').textContent = 'AWS ' + cert.name;
      document.getElementById('examQCount').textContent = cert.questions;
      document.getElementById('examTCount').textContent = cert.time;
      document.getElementById('examPScore').textContent = cert.passScore + '%';

      // Update category buttons
      const btnContainer = document.getElementById('categoryBtns');
      btnContainer.innerHTML = `<button class="btn btn-primary category-btn" data-cat="all" onclick="setCategory('all')">All Domains</button>`;
      cert.domains.forEach(d => {
        btnContainer.innerHTML += `<button class="btn btn-secondary category-btn" data-cat="${d}" onclick="setCategory('${d}')">${cert.domainLabels[d]}</button>`;
      });

      // Update domain progress
      const progContainer = document.getElementById('domainProgress');
      progContainer.innerHTML = '';
      cert.domains.forEach(d => {
        const stats = quizStats.byCategory[d] || { correct: 0, total: 0 };
        const pct = stats.total > 0 ? Math.round((stats.correct / stats.total) * 100) : 0;
        const progClass = pct >= 70 ? 'good' : pct >= 40 ? 'medium' : 'low';
        progContainer.innerHTML += `
          <div>
            <label>${cert.domainLabels[d]}</label>
            <div class="progress-bar"><div class="progress-fill ${progClass}" style="width:${pct}%"></div></div>
            <span style="font-size:.75rem;color:var(--muted)">${stats.correct}/${stats.total} (${pct}%)</span>
          </div>
        `;
      });

      updateDashboard();
    }

    function setCategory(cat) {
      currentCategory = cat;
      document.querySelectorAll('.category-btn').forEach(btn => {
        btn.classList.remove('btn-primary');
        btn.classList.add('btn-secondary');
        if (btn.dataset.cat === cat) {
          btn.classList.add('btn-primary');
          btn.classList.remove('btn-secondary');
        }
      });
      filteredQuestions = cat === 'all' ? [...questions] : questions.filter(q => q.cat === cat);
      shuffleArray(filteredQuestions);
      currentQuestionIndex = 0;
      loadQuestion();
    }

    function loadQuestion() {
      if (filteredQuestions.length === 0) {
        document.getElementById('quizQuestion').textContent = 'No questions in this category!';
        document.getElementById('quizOptions').innerHTML = '';
        return;
      }
      const q = filteredQuestions[currentQuestionIndex];
      const cert = certifications[currentCert];
      document.getElementById('quizCategory').textContent = cert.domainLabels[q.cat] || q.cat;
      document.getElementById('quizQuestion').textContent = q.q;
      document.getElementById('questionCounter').textContent = `(${currentQuestionIndex + 1}/${filteredQuestions.length})`;
      document.getElementById('quizOptions').innerHTML = q.options.map((opt, i) => `
        <div class="quiz-option" onclick="checkAnswer(${i})">${opt}</div>
      `).join('');
      document.getElementById('quizExplanation').style.display = 'none';
      document.getElementById('nextQuizBtn').style.display = 'none';
    }

    function checkAnswer(selected) {
      const q = filteredQuestions[currentQuestionIndex];
      const options = document.querySelectorAll('#quizOptions .quiz-option');
      options.forEach((opt, i) => {
        opt.style.pointerEvents = 'none';
        if (i === q.answer) opt.classList.add('correct');
        if (i === selected && selected !== q.answer) opt.classList.add('incorrect');
      });

      quizStats.total++;
      if (!quizStats.byCategory[q.cat]) quizStats.byCategory[q.cat] = { correct: 0, total: 0 };
      quizStats.byCategory[q.cat].total++;

      if (selected === q.answer) {
        quizStats.correct++;
        quizStats.currentStreak++;
        quizStats.byCategory[q.cat].correct++;
        if (quizStats.currentStreak > quizStats.bestStreak) quizStats.bestStreak = quizStats.currentStreak;
      } else {
        quizStats.currentStreak = 0;
        answeredQuestions.push({ q: q.q, cat: q.cat, correct: false, date: new Date().toISOString() });
      }

      DB.setOne('quizStats_' + currentCert, quizStats);
      DB.set('answeredQuestions_' + currentCert, answeredQuestions.slice(-200));

      const explainEl = document.getElementById('quizExplanation');
      explainEl.innerHTML = `<strong>${selected === q.answer ? '‚úÖ Correct!' : '‚ùå Incorrect'}</strong><br>${q.explain}`;
      explainEl.style.display = 'block';
      explainEl.style.borderLeftColor = selected === q.answer ? 'var(--success)' : 'var(--danger)';

      document.getElementById('nextQuizBtn').style.display = 'inline-block';
      updateUI();
    }

    function nextQuestion() {
      currentQuestionIndex = (currentQuestionIndex + 1) % filteredQuestions.length;
      if (currentQuestionIndex === 0) shuffleArray(filteredQuestions);
      loadQuestion();
    }

    function resetQuiz() {
      if (confirm('Reset all progress for ' + certifications[currentCert].name + '?')) {
        quizStats = { correct: 0, total: 0, bestStreak: 0, currentStreak: 0, byCategory: {} };
        answeredQuestions = [];
        DB.setOne('quizStats_' + currentCert, quizStats);
        DB.set('answeredQuestions_' + currentCert, []);
        updateUI();
      }
    }

    function updateDashboard() {
      document.getElementById('totalAnswered').textContent = quizStats.total;
      document.getElementById('totalAccuracy').textContent = quizStats.total > 0 ? Math.round((quizStats.correct / quizStats.total) * 100) + '%' : '--%';
      document.getElementById('bestStreak').textContent = quizStats.bestStreak;

      const accuracy = quizStats.total > 0 ? (quizStats.correct / quizStats.total) * 100 : 0;
      const cert = certifications[currentCert];
      const ready = accuracy >= cert.passScore && quizStats.total >= 30;
      document.getElementById('examReady').textContent = ready ? 'Yes!' : 'No';
      document.getElementById('examReady').style.color = ready ? 'var(--success)' : 'var(--danger)';

      // Weak areas
      const container = document.getElementById('weakAreas');
      const wrongByCat = {};
      answeredQuestions.filter(a => !a.correct).forEach(a => {
        wrongByCat[a.cat] = (wrongByCat[a.cat] || 0) + 1;
      });
      const weakCats = Object.entries(wrongByCat).sort((a, b) => b[1] - a[1]).slice(0, 3);

      if (weakCats.length === 0) {
        container.innerHTML = '<div class="insight positive">No weak areas yet - keep practicing!</div>';
      } else {
        container.innerHTML = weakCats.map(([cat, count]) => `
          <div class="data-item" onclick="document.querySelector('[data-tab=quiz]').click(); setCategory('${cat}')">
            <div class="data-item-info">
              <div class="data-item-title">${cert.domainLabels[cat] || cat}</div>
              <div class="data-item-meta">${count} incorrect - Click to practice</div>
            </div>
            <div class="data-item-value" style="color:var(--danger)">${count}</div>
          </div>
        `).join('');
      }
    }

    // Exam Functions
    function startExam() {
      const cert = certifications[currentCert];
      examQuestions = [...questions];
      shuffleArray(examQuestions);
      examQuestions = examQuestions.slice(0, cert.questions);
      examIndex = 0;
      examAnswers = new Array(cert.questions).fill(-1);
      examTimeLeft = cert.time * 60;

      document.getElementById('examStart').style.display = 'none';
      document.getElementById('examInProgress').style.display = 'block';
      document.getElementById('examResults').style.display = 'none';

      loadExamQuestion();
      examTimer = setInterval(updateExamTimer, 1000);
    }

    function loadExamQuestion() {
      const q = examQuestions[examIndex];
      document.getElementById('examProgress').textContent = `Question ${examIndex + 1} of ${examQuestions.length}`;
      document.getElementById('examQuestion').textContent = q.q;
      document.getElementById('examOptions').innerHTML = q.options.map((opt, i) => `
        <div class="quiz-option ${examAnswers[examIndex] === i ? 'selected' : ''}" onclick="selectExamAnswer(${i})" style="${examAnswers[examIndex] === i ? 'border-color:var(--aws-orange)' : ''}">${opt}</div>
      `).join('');
    }

    function selectExamAnswer(i) {
      examAnswers[examIndex] = i;
      loadExamQuestion();
    }

    function examNext() {
      if (examIndex < examQuestions.length - 1) {
        examIndex++;
        loadExamQuestion();
      } else {
        endExam();
      }
    }

    function updateExamTimer() {
      examTimeLeft--;
      const mins = Math.floor(examTimeLeft / 60);
      const secs = examTimeLeft % 60;
      document.getElementById('examTimer').textContent = `${mins}:${secs.toString().padStart(2, '0')}`;
      if (examTimeLeft <= 0) endExam();
    }

    function endExam() {
      clearInterval(examTimer);
      let correct = 0;
      examQuestions.forEach((q, i) => {
        if (examAnswers[i] === q.answer) correct++;
      });
      const score = Math.round((correct / examQuestions.length) * 100);
      const cert = certifications[currentCert];
      const passed = score >= cert.passScore;

      document.getElementById('examInProgress').style.display = 'none';
      document.getElementById('examResults').style.display = 'block';
      document.getElementById('examScore').textContent = score + '%';
      document.getElementById('examCorrect').textContent = correct + '/' + examQuestions.length;
      document.getElementById('examResult').textContent = passed ? '‚úÖ PASSED' : '‚ùå FAILED';
      document.getElementById('examResult').style.color = passed ? 'var(--success)' : 'var(--danger)';
    }

    function restartExam() {
      document.getElementById('examStart').style.display = 'block';
      document.getElementById('examResults').style.display = 'none';
    }

    // Services
    function loadServices() {
      document.getElementById('serviceGrid').innerHTML = awsServices.map(s => `
        <div class="service-card">
          <div class="service-name">${s.name}</div>
          <div class="service-desc">${s.desc}</div>
          <span style="font-size:.75rem;background:var(--card);padding:.25rem .5rem;border-radius:4px">${s.cat}</span>
        </div>
      `).join('');
    }

    function filterServices() {
      const search = document.getElementById('serviceSearch').value.toLowerCase();
      const filtered = awsServices.filter(s =>
        s.name.toLowerCase().includes(search) ||
        s.desc.toLowerCase().includes(search) ||
        s.cat.toLowerCase().includes(search)
      );
      document.getElementById('serviceGrid').innerHTML = filtered.map(s => `
        <div class="service-card">
          <div class="service-name">${s.name}</div>
          <div class="service-desc">${s.desc}</div>
          <span style="font-size:.75rem;background:var(--card);padding:.25rem .5rem;border-radius:4px">${s.cat}</span>
        </div>
      `).join('');
    }

    // Initialize
    document.getElementById('certSelector').value = currentCert;
    shuffleArray(filteredQuestions);
    updateUI();
    loadQuestion();
    loadServices();
  </script>
</body>
</html>
